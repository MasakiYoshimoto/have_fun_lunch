<?php
//PHP始まるよ↑セッション使うよ↓
session_start();
// DB接続
$con = mysqli_connect('localhost', 'root', '');
// 使用するDB名の指定
mysqli_select_db($con,'havefunlunch_system');
//文字コードを指定
mysqli_set_charset($con,'utf8');
// User情報取得
$sql = "SELECT id,first_name,last_name from m_user where id ='".$_POST["id"]."' and password = '".$_POST["pass"]."'";
// クエリ実行・結果を代入
$responce = mysqli_query($con,$sql);

//空の配列を作成
$user_info = array();

//responceの内容を1行づつ変換して、変数に代入（responceの内容分ループ）
while($row = mysqli_fetch_assoc($responce)){
  //1行になった内容を配列に代入
  $user_info[] = $row;
}

// ログイン判定
if(empty($user_info)){
  //失敗だった場合
  //エラーメッセージを作成
  $_SESSION["error"]["msg"]="ログイン失敗しました。";
  //前の画面に遷移
  header("location:index.html");

  exit();
}
//成功だった場合
if(!empty($_SESSION["error"]["msg"])){
  unset($_SESSION["error"]["msg"]);
}

?>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>top-page-havefunlunch</title>
  </head>
  <body>
    toppage
    <div>
<?php
echo $user_info['0']['last_name'];
?>
<?php
//複数行表示する場合はこの書き方
// foreach($user_info as $key => $value){
//   echo "こんにちは ".$value["first_name"]." さん";
// }
?>
    </div>
  </body>
</html>
